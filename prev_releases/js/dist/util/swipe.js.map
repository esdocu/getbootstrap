{"version":3,"file":"swipe.js","sources":["../../src/util/swipe.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap (v5.1.3): util/swipe.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport Config from './config'\nimport EventHandler from '../dom/event-handler'\nimport { execute } from './index'\n\n/**\n * Constants\n */\n\nconst NAME = 'swipe'\nconst EVENT_KEY = '.bs.swipe'\nconst EVENT_TOUCHSTART = `touchstart${EVENT_KEY}`\nconst EVENT_TOUCHMOVE = `touchmove${EVENT_KEY}`\nconst EVENT_TOUCHEND = `touchend${EVENT_KEY}`\nconst EVENT_POINTERDOWN = `pointerdown${EVENT_KEY}`\nconst EVENT_POINTERUP = `pointerup${EVENT_KEY}`\nconst POINTER_TYPE_TOUCH = 'touch'\nconst POINTER_TYPE_PEN = 'pen'\nconst CLASS_NAME_POINTER_EVENT = 'pointer-event'\nconst SWIPE_THRESHOLD = 40\n\nconst Default = {\n  leftCallback: null,\n  rightCallback: null,\n  endCallback: null\n}\n\nconst DefaultType = {\n  leftCallback: '(function|null)',\n  rightCallback: '(function|null)',\n  endCallback: '(function|null)'\n}\n\n/**\n * Class definition\n */\n\nclass Swipe extends Config {\n  constructor(element, config) {\n    super()\n    this._element = element\n\n    if (!element || !Swipe.isSupported()) {\n      return\n    }\n\n    this._config = this._getConfig(config)\n    this._deltaX = 0\n    this._supportPointerEvents = Boolean(window.PointerEvent)\n    this._initEvents()\n  }\n\n  // Getters\n  static get Default() {\n    return Default\n  }\n\n  static get DefaultType() {\n    return DefaultType\n  }\n\n  static get NAME() {\n    return NAME\n  }\n\n  // Public\n  dispose() {\n    EventHandler.off(this._element, EVENT_KEY)\n  }\n\n  // Private\n  _start(event) {\n    if (!this._supportPointerEvents) {\n      this._deltaX = event.touches[0].clientX\n\n      return\n    }\n\n    if (this._eventIsPointerPenTouch(event)) {\n      this._deltaX = event.clientX\n    }\n  }\n\n  _end(event) {\n    if (this._eventIsPointerPenTouch(event)) {\n      this._deltaX = event.clientX - this._deltaX\n    }\n\n    this._handleSwipe()\n    execute(this._config.endCallback)\n  }\n\n  _move(event) {\n    this._deltaX = event.touches && event.touches.length > 1 ?\n      0 :\n      event.touches[0].clientX - this._deltaX\n  }\n\n  _handleSwipe() {\n    const absDeltaX = Math.abs(this._deltaX)\n\n    if (absDeltaX <= SWIPE_THRESHOLD) {\n      return\n    }\n\n    const direction = absDeltaX / this._deltaX\n\n    this._deltaX = 0\n\n    if (!direction) {\n      return\n    }\n\n    execute(direction > 0 ? this._config.rightCallback : this._config.leftCallback)\n  }\n\n  _initEvents() {\n    if (this._supportPointerEvents) {\n      EventHandler.on(this._element, EVENT_POINTERDOWN, event => this._start(event))\n      EventHandler.on(this._element, EVENT_POINTERUP, event => this._end(event))\n\n      this._element.classList.add(CLASS_NAME_POINTER_EVENT)\n    } else {\n      EventHandler.on(this._element, EVENT_TOUCHSTART, event => this._start(event))\n      EventHandler.on(this._element, EVENT_TOUCHMOVE, event => this._move(event))\n      EventHandler.on(this._element, EVENT_TOUCHEND, event => this._end(event))\n    }\n  }\n\n  _eventIsPointerPenTouch(event) {\n    return this._supportPointerEvents && (event.pointerType === POINTER_TYPE_PEN || event.pointerType === POINTER_TYPE_TOUCH)\n  }\n\n  // Static\n  static isSupported() {\n    return 'ontouchstart' in document.documentElement || navigator.maxTouchPoints > 0\n  }\n}\n\nexport default Swipe\n"],"names":["NAME","EVENT_KEY","EVENT_TOUCHSTART","EVENT_TOUCHMOVE","EVENT_TOUCHEND","EVENT_POINTERDOWN","EVENT_POINTERUP","POINTER_TYPE_TOUCH","POINTER_TYPE_PEN","CLASS_NAME_POINTER_EVENT","SWIPE_THRESHOLD","Default","leftCallback","rightCallback","endCallback","DefaultType","Swipe","Config","constructor","element","config","_element","isSupported","_config","_getConfig","_deltaX","_supportPointerEvents","Boolean","window","PointerEvent","_initEvents","dispose","EventHandler","off","_start","event","touches","clientX","_eventIsPointerPenTouch","_end","_handleSwipe","execute","_move","length","absDeltaX","Math","abs","direction","on","classList","add","pointerType","document","documentElement","navigator","maxTouchPoints"],"mappings":"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"}